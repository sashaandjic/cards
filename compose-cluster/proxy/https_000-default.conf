# Licensed to the Apache Software Foundation (ASF) under one
# or more contributor license agreements.  See the NOTICE file
# distributed with this work for additional information
# regarding copyright ownership.  The ASF licenses this file
# to you under the Apache License, Version 2.0 (the
# "License"); you may not use this file except in compliance
# with the License.  You may obtain a copy of the License at
#
# http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing,
# software distributed under the License is distributed on an
# "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
# KIND, either express or implied.  See the License for the
# specific language governing permissions and limitations
# under the License.

<VirtualHost *:443>
	SSLEngine on
	SSLProtocol all -TLSv1.1 -TLSv1 -SSLv2 -SSLv3
	SSLCipherSuite ALL:!ADH:!EXPORT:!SSLv2:!RC4+RSA:!RC4:+HIGH:!MEDIUM:!LOW

	SSLCertificateFile /etc/cert/certificate.crt
	SSLCertificateKeyFile /etc/cert/certificatekey.key
	SSLCertificateChainFile /etc/cert/certificatechain.crt

	Header unset WWW-Authenticate
	Header always set Strict-Transport-Security "max-age=31536000"
	Header always set X-Frame-Options "DENY"
	Header edit location ^http://(.*)$ https://$1
	Header edit Set-Cookie ^(.*)$ $1;Secure
	ProxyPreserveHost On

	DocumentRoot "/var/www/html"
	ErrorDocument 503 /proxyerror/503.html

	<Location "/">
		ProxyPass http://cardsinitial:8080/
		ProxyPassReverse http://cardsinitial:8080/
	</Location>

	<Location "/proxyerror">
		ProxyPass !
	</Location>

	<Location "/ncr/">
		ProxyPass http://127.0.0.1:8600/
		ProxyPassReverse http://127.0.0.1:8600/
	</Location>

</VirtualHost>

<VirtualHost *:444>
	SSLEngine on
	SSLProtocol all -TLSv1.1 -TLSv1 -SSLv2 -SSLv3
	SSLCipherSuite ALL:!ADH:!EXPORT:!SSLv2:!RC4+RSA:!RC4:+HIGH:!MEDIUM:!LOW

	SSLCertificateFile /etc/cert/certificate.crt
	SSLCertificateKeyFile /etc/cert/certificatekey.key
	SSLCertificateChainFile /etc/cert/certificatechain.crt

	RequestHeader unset Authorization
	Header unset WWW-Authenticate
	Header always set Strict-Transport-Security "max-age=31536000"
	Header always set X-Frame-Options "DENY"
	Header edit location ^http://(.*)$ https://$1
	Header edit Set-Cookie ^(.*)$ $1;Secure
	ProxyPreserveHost On

	DocumentRoot "/var/www/html"
	ErrorDocument 503 /proxyerror/503.html

	<Location "/">
		ProxyPass http://cardsinitial:8080/
		ProxyPassReverse http://cardsinitial:8080/
	</Location>

	<Location "/proxyerror">
		ProxyPass !
	</Location>

	<Location "/j_security_check">
		order allow,deny
		deny from all
	</Location>

	<Location "/ncr/">
		ProxyPass http://127.0.0.1:8600/
		ProxyPassReverse http://127.0.0.1:8600/
	</Location>

</VirtualHost>
